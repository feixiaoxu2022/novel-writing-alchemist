# Content Quality Basic Layer - LLM Judge Criteria
# 版本：v1.3
# 创建时间：2026-02-05
# 最后更新：2026-02-06
# 说明：定义content_quality维度basic层的检查项的评估标准
#
# 版本历史：
# v1.3 (2026-02-06): 新增full_narrative_content（完整叙事文本）检查项，区分完整小说正文vs大纲罗列，识别偷懒写大纲的行为
# v1.2 (2026-02-06): 新增character_design_adherence（人物设计遵循度）检查项，验证plan阶段设计与execute阶段实际表现的一致性
# v1.1 (2026-02-05): 修正主题一致性和情节推进的返回格式，从评分格式改为matched格式，与checker解析逻辑保持一致
# v1.0 (2026-02-05): 初始版本，定义6个basic层检查项的LLM评估标准

## 主题一致性
llm_judge_criteria: |
  # 评分标准（matched: true/false）

  **【重要】本检查项的范围约束**：
  - ✅ 只检查：故事的核心主题是否从开篇到结尾保持一致，主线是否清晰
  - ❌ 不检查：逻辑硬伤、设定冲突、章节编号错误、角色本体矛盾、世界观规则冲突
  - ❌ 即使逻辑硬伤会"削弱主题表达"，也不要归入本项，那是"检查项19:逻辑硬伤"的范围

  **不合格（matched: false）：主题严重漂移**
  - 开篇是复仇故事，中段变成商战，结尾又变修仙（**主题类型完全换了**）
  - 前后主题无关联，读者会困惑"这到底是什么故事"
  - 核心主题中途被完全替换，无法识别作品的统一主题
  - 示例：开篇定位"校园爱情"，中段变"悬疑探案"，结尾变"科幻穿越"（主题完全散了）

  **合格（matched: true）：主题基本一致**
  - 核心主题贯穿始终（如复仇主题从开篇到结尾都在推进）
  - 允许有支线（如复仇过程中涉及商业手段、权谋布局），但这些是实现主题的方式，不是新主题
  - 主题可以有深化（如从单纯复仇升华为正义），但核心不变
  - 所有情节都围绕核心主题展开，虽然可能有偏离但主线清晰
  - 示例：始终是"执念救赎+爱与牺牲"主题，虽然表现形式（副本、规则）有变化，但主题不变

  **严格区分：主题漂移 vs 逻辑硬伤**
  - ✅ 真主题漂移：开篇是爱情故事 → 中段变复仇故事 → 结尾变修仙故事（主题类型完全换了）
  - ❌ 不是主题漂移：始终是"执念救赎"主题，但角色身份设定前后矛盾（这是逻辑硬伤，不是主题漂移）
  - ❌ 不是主题漂移：始终是"复仇"主题，但章节编号错乱（这是结构问题，不是主题漂移）
  - ❌ 不是主题漂移：始终是"爱情"主题，但世界观规则前后冲突（这是逻辑硬伤，不是主题漂移）

  **具体排除清单**（这些不属于本项）：
  - ⚠️ 不属于本项：角色本体设定前后矛盾（如"执念投影"→"系统工具"→"植物人"）
  - ⚠️ 不属于本项：章节编号/副本序号错乱（如第4→第5→第7→第8编号跳跃）
  - ⚠️ 不属于本项：世界观规则冲突（如"绑定规则"前后矛盾）
  - ⚠️ 不属于本项：梗概与正文事实冲突（这是客观事实矛盾）
  - ⚠️ 不属于本项：因果链断裂、时间线错乱（这些都是逻辑硬伤）

  **验证要点**：
  1. 提取creative_intent.json中的核心主题（如"复仇"、"爱情"、"成长"、"救赎"）
  2. 检查各章节是否持续推进**这个主题类型**（而不是检查逻辑是否一致）
  3. 区分"主题漂移"（主题类型完全换了）vs"逻辑硬伤"（主题不变但逻辑有问题）
  4. **关键判断**：如果主题意图层面一致（如都是"救赎"主题），即使有逻辑冲突，也应判定主题一致

  **判断流程**：
  - 先问：核心主题类型（复仇/爱情/成长/救赎等）是否从开篇到结尾保持一致？
  - 如果主题类型一致 → matched=true（即使有逻辑硬伤也不影响主题一致性判定）
  - 如果主题类型完全换了 → matched=false（真主题漂移）
  - 不要因为"逻辑硬伤削弱了主题表达"就判定为主题不一致

  请判断主题是否保持一致，回复JSON格式：{"matched": true/false, "reason": "只说明核心主题类型是否一致，不要提及逻辑硬伤、设定冲突等问题"}

---

## 主要角色一致性
llm_judge_criteria: |
  # 评分标准（matched: true/false）

  **【重要】本检查项的范围约束**：
  - ✅ 只检查：故事的主角（第一/第二主角）是否从开篇到结尾持续存在并保持核心身份
  - ✅ 检查主角是否中途被替换、消失、或被配角抢占戏份导致主角地位丧失
  - ❌ 不检查：主角的性格是否一致（那是"人物设定一致性"的范围）
  - ❌ 不检查：主角表现是否符合设计文档（那是"人物设计遵循度"的范围）
  - ❌ 不检查：客观事实矛盾（那是"逻辑硬伤"的范围）

  **不合格（matched: false）：主角存续性问题**
  - **主角消失**：主角在某章之后完全不再出现，没有任何交代（非剧情需要的暂时离场）
  - **主角被替换**：前几章的主角是A，后几章突然换成B成为叙事中心，A沦为配角或消失
  - **主角身份断裂**：同一个"主角"在前后章节中变成了完全不同的人（不是性格变化，而是身份层面的断裂——如前文是警察张三，后文变成了商人李四，且无剧情解释）
  - **主角戏份被严重挤占**：主角沦为旁观者，配角占据了绝大部分（>70%）的叙事视角和决策权
  - **多主角场景中某主角被遗忘**：如双男主/双女主设定，其中一个主角在中后期完全消失

  **合格（matched: true）：主角持续存在且保持核心地位**
  - 主角从开篇到结尾持续出现在叙事中，是故事的核心推动者
  - 如果有暂时离场（如被囚禁、失联），有明确的剧情交代，且后续回归
  - 多主角场景中，各主角都有足够的戏份和存在感
  - 允许叙事视角偶尔切换到配角（如展示反派视角），但主角始终是故事中心
  - 允许主角身份的剧情揭示（如"原来他不是普通人而是卧底"），这是剧情设计而非身份断裂

  **严格区分：主角存续性 vs 其他问题**：
  - ✅ 本项关注：主角"还在不在"、"还是不是主角"
  - ❌ 不是本项：主角性格变了（那是人物设定一致性）
  - ❌ 不是本项：主角表现不符合设计（那是人物设计遵循度）
  - ❌ 不是本项：主角做了不合逻辑的事（那是逻辑硬伤）
  - ⚠️ 边界情况：主角身份揭示（如"他其实是XXX"）→ 如果是同一个人的身份层被揭开，不算身份断裂，算合格
  - ⚠️ 边界情况：主角死亡但以其他形式存在（如回忆、精神影响）→ 如果有剧情铺垫且叙事中心仍围绕该角色，算合格

  **验证要点**：
  1. 从characters.json或creative_intent.json中识别主角（通常是前1-2个main_character）
  2. 逐章检查：主角是否出现？是否是叙事中心？
  3. 如果主角在某章未出现，是否有合理的剧情原因？
  4. 多主角场景中，各主角的戏份是否均衡？是否有被遗忘的主角？
  5. 叙事视角是否持续以主角为中心？配角视角是否只是偶尔穿插？

  **判断流程**：
  - 先问：谁是主角？（从设计文档或前几章识别）
  - 再问：主角是否从头到尾都在故事中？
  - 如果有主角缺席的章节，是否有合理的剧情交代？
  - 如果主角的叙事戏份被大量挤占（>70%视角给了配角），判定不合格
  - 如果主角中途被替换且无剧情解释，判定不合格

  请判断主角是否持续存在并保持核心地位，回复JSON格式：{"matched": true/false, "reason": "说明主角在各章节的存在情况，如有问题指出在哪里消失/被替换/被挤占"}

---

## 人物设定一致性
llm_judge_criteria: |
  # 评分标准（matched: true/false）

  **【重要】本检查项的范围约束**：
  - ✅ 只检查：同一角色在不同章节之间的性格特质、行为模式是否前后一致（execute内部一致性）
  - ✅ 对比基准是"章节之间的前后对比"（chapter_01的角色A vs chapter_05的角色A）
  - ❌ 不检查：角色表现是否符合characters.json设计文档（那是"人物设计遵循度"的范围）
  - ❌ 不检查：客观事实错误、世界观设定矛盾、物品数量冲突、时间线错误（那是"逻辑硬伤"的范围）
  - ❌ 不检查：剧情揭示节奏问题（如misperception何时消解、secret何时揭示）

  **不合格（matched: false）：人物性格/行为真崩坏**
  - 前几章表现为聪明绝顶 → 后面突然降智做蠢事（无合理原因，如明明知道陷阱还主动跳）
  - 前几章表现为善良温柔 → 后面突然残忍冷血（无铺垫无转折）
  - 前几章表现为武功高强 → 后面被小喽啰打败（能力水平前后不一致）
  - 人物核心动机前后自相矛盾（如前文"想复仇"，后文"不想复仇"，无转折解释）
  - 同一角色的性格底色在章节间反复摇摆（如第1章冷静→第2章冲动→第3章又冷静→第4章又冲动，无情境解释）

  **合格（matched: true）：性格/行为保持一致**
  - 角色的性格底色、行为模式、核心动机在各章节间保持稳定
  - 如果人物发生转变，有合理的铺垫和动机（如经历背叛后从单纯变谨慎）
  - 允许在情境压力下的合理反应（如谨慎的人被逼急了变莽撞，但事后回归谨慎）
  - 允许因剧情事件导致的合理行为变化（如得知真相后态度转变、经历创伤后性格改变）

  **区分"人设崩坏"vs"合理变化"vs"其他问题"**：
  - ✅ 不算人设崩坏：谨慎的人被逼急了变莽撞（有情境压力，事后回归，合理）
  - ✅ 不算人设崩坏：单纯的人经历背叛后变谨慎（有铺垫的性格成长）
  - ✅ 不算人设崩坏：角色得知隐藏真相后行为模式改变（如发现对方身份后从防备变信任）——这是剧情驱动的合理转变
  - ❌ 真人设崩坏：聪明人无缘无故反复降智（无铺垫，性格特质不稳定）
  - ❌ 真人设崩坏：同一角色的性格底色在各章之间无规律地来回切换
  - ⚠️ 不属于本项：枕巾数量从40对变成50对再变1对（这是客观事实错误，属于"逻辑硬伤"）
  - ⚠️ 不属于本项：角色身份从"执念投影"变成"系统工具"再变"植物人"（这是世界观设定矛盾，属于"逻辑硬伤"）
  - ⚠️ 不属于本项：时间线错乱、空间矛盾（这些是"逻辑硬伤"）
  - ⚠️ 不属于本项：角色表现不符合characters.json的设计（那是"人物设计遵循度"）

  **验证要点**：
  1. 扫描所有章节，提取各角色在不同章节中的性格表现和行为模式
  2. 对比同一角色在前后章节中的表现：性格底色是否稳定？核心动机是否一贯？
  3. 如果有性格转变，判断是否有合理的铺垫和动机（剧情事件触发的转变是合理的）
  4. **严格排除**：不要把客观事实错误（数量、身份本质、时间线）归入本项
  5. **严格排除**：不要把角色与characters.json设计文档的对比归入本项（那是另一个检查项）

  **判断流程**：
  - 先问：这是人物性格/行为在章节间的问题，还是客观事实/世界观的问题？
  - 如果是客观事实错误 → 不属于本项，跳过
  - 如果是角色与design文档不符 → 不属于本项（那是人物设计遵循度），跳过
  - 如果是人物性格/行为在章节间不一致 → 继续判断：有没有合理的剧情铺垫导致这种变化？
  - 有合理铺垫 → matched=true（合理成长/转变）
  - 无合理铺垫、性格无故崩坏或反复摇摆 → matched=false

  请判断人物设定是否一致，回复JSON格式：{"matched": true/false, "reason": "只说明角色的性格/行为/动机在各章节之间是否一致，不要提及客观事实错误，不要对比characters.json设计文档"}

---

## 逻辑硬伤
llm_judge_criteria: |
  # 评分标准（matched: true/false）

  **【重要】本检查项的范围约束**：
  - ✅ 检查：客观事实前后矛盾、世界观设定冲突、时空逻辑错误、数量/状态冲突
  - ✅ 这里应该检查那些从"人物设定一致性"排除的问题（如枕巾数量冲突、身份本质设定互斥）
  - ❌ 不检查：纯粹的人物性格/行为一致性问题（那是"检查项18:人物设定一致性"的范围）

  **不合格（matched: false）：有逻辑硬伤**
  - **生死状态矛盾**：前面说某人已死（尸体腐烂），后面又活着出现（无解释）
  - **判决/事实矛盾**：前面判无期徒刑，后面变成死刑（无解释的矛盾）
  - **时间线错乱**：前面是2020年，后面突然变2018年（时间倒流）
  - **空间矛盾**：同一场景下，前一章在北京，下一章在上海（无交代移动）
  - **客观数量冲突**：枕巾从40对→50对→只剩1对→又变4对（数字自相矛盾）
  - **角色本体设定互斥**：角色身份从"执念投影"→"系统工具"→"植物人"，三种解释并存且无统一
  - **世界观规则冲突**：前面建立的规则A，后面又用规则B覆盖（无解释）
  - **能力边界突变**：角色突然展现前文未铺垫的能力（如NPC突然能访问后台监控），与设定冲突

  **合格（matched: true）：无逻辑硬伤**
  - 前后事件、设定、时间线、空间逻辑、客观数量保持一致
  - 如果有看似矛盾的地方，有合理的解释（如假死、改判、规则升级等）

  **重要区分**：
  - ✅ 真硬伤：枕巾数量40→50→1→4，前后数字冲突（客观事实错误）
  - ✅ 真硬伤：角色身份A→B→C三种解释并存（世界观设定互斥）
  - ✅ 真硬伤：前面说死了，后面又活了（无任何解释）
  - ❌ 不算硬伤：商业对手突然变弟弟（铺垫不足，但不是前后矛盾）
  - ❌ 不算硬伤：背景不清的女子选秀（合理性不足，但不是逻辑矛盾）
  - ⚠️ 不属于本项：人物从聪明突然变愚蠢（这是性格一致性问题，属于检查项18）

  **验证要点**：
  1. 扫描所有章节，查找前后矛盾的**客观事实**（生死、判决、时空、数量、身份本质）
  2. 如果发现矛盾，检查是否有解释（如假死、改判的剧情）
  3. 只标记"硬伤"（明确的前后矛盾），不标记"不合理"（铺垫不足）
  4. **包含客观物品/数量**：如枕巾数量前后冲突，应归入本项
  5. **包含世界观设定**：如角色本体身份的多版本互斥，应归入本项

  **判断流程**：
  - 先问：这是客观事实/世界观的矛盾，还是人物性格/行为的问题？
  - 如果是客观事实/世界观矛盾 → 继续判断是否有逻辑硬伤
  - 如果是人物性格/行为问题 → 不属于本项，跳过

  请判断是否存在逻辑硬伤，回复JSON格式：{"matched": true/false, "reason": "具体说明客观事实/世界观哪里有矛盾，或确认无矛盾"}

---

## 语言纯净性
llm_judge_criteria: |
  # 评分标准（matched: true/false）

  **不合格（matched: false）：不合理的多语言混用**
  - 中英混杂无意义：'他very生气地说'、'这个idea真的不错'、'他feeling到了危险'
  - 日文混用：'今天很sugoi呢'（无情节需要）
  - 大段外语无翻译（非角色对话场景）

  **合格（matched: true）：语言使用合理**
  - 主要叙事语言统一（如中文故事就用中文叙事）
  - 合理的外语使用（情节必需）：
    * 人名：'John是一位美国商人'（人名本身就是英文）
    * 品牌名：'他们在Starbucks见面'（专有品牌名）
    * 角色对话：'她说了一句"Good morning"'（角色说外语）
    * 专业术语：'AI技术'、'DNA检测'（约定俗成的术语）

  **判断标准**：
  - 如果是人名、地名、品牌、术语、角色说外语 → 合理
  - 如果是无意义的语言炫技（中英混杂句子） → 不合理

  **验证要点**：
  1. 扫描所有章节，查找外语（英文、日文等）出现位置
  2. 判断每处外语是否有情节必要性（人名/品牌/对话/术语）
  3. 如果有大量无意义的混用，判定为不合格

  请判断语言使用是否纯净，回复JSON格式：{"matched": true/false, "reason": "说明是否有不合理混用，或确认语言使用合理"}

---

## 情节推进
llm_judge_criteria: |
  # 评分标准（matched: true/false）

  **不合格（matched: false）：缺乏实质情节推进**
  - 章节主要由静态对话或内心独白构成（占比>70%）
  - 无具体的故事事件发生（两人站着聊天，讨论情感和想法）
  - 场景静止，无时间/空间推进
  - 角色无实质性行动，仅停留在情感表达
  - 故事事件数量少于2个，无法构成基本的情节推进

  **合格（matched: true）：有基本的情节推进**
  - 有一定的故事事件（至少2-3个具体事件）
  - 事件与情感描写基本平衡（事件占比40%以上）
  - 有场景变化或时间推进
  - 角色有具体行动，不仅是对话
  - 事件之间有基本的逻辑关联，推动故事发展

  **验证提示**：
  1. **故事事件密度**：
     - 统计具体的故事事件数量（行动、发现、转折、冲突）
     - 区分"事件"（有实质推进）vs"描写"（静态展示）

  2. **内容占比分析**：
     - 故事事件占比是否≥40%？
     - 纯对话和内心独白占比是否<70%？

  3. **情节推进节奏**：
     - 是否有明确的时间/空间变化？
     - 角色是否有具体行动（而非仅对话）？
     - 事件之间是否有逻辑关联？

  4. **典型不合格问题**：
     - 出现"俩人站着聊天"且无实质内容的场景
     - 大段内心独白但无外部事件
     - 场景静止、无故事推进

  请判断章节是否有足够的情节推进，回复JSON格式：{"matched": true/false, "reason": "具体说明事件数量、内容占比、是否有实质推进"}

---

## 人物设计遵循度
llm_judge_criteria: |
  # 评分标准（matched: true/false）

  **【重要】本检查项的范围约束**：
  - ✅ 只检查：角色"是什么样的人"——性格特质、核心动机方向、行为模式是否符合characters.json的设计
  - ✅ 这是检查Plan阶段（characters.json设计文档）vs Execute阶段（chapters/*.md实际表现）的一致性
  - ❌ 不检查：章节之间的人物性格一致性（那是检查项18）、主角是否换人（那是检查项17）、客观事实错误（那是检查项19）
  - ❌ 不检查：剧情揭示时机/叙事节奏问题（如misperception被过早消解、hidden_connection提前暴露、关系发展节奏过快）——这些是"故事怎么讲"的问题，不是"人设对不对"的问题

  **不合格（matched: false）：实际表现与设计严重不符**
  - **性格特质不符**：characters.json定义"沉默寡言、外冷内热" → chapters中表现为话痨、热情外向、感情外露
  - **性格特质不符**：characters.json定义"倔强、细腻、隐忍" → chapters中表现为软弱、粗犷、情绪失控
  - **核心能力不符**：characters.json定义"聪明绝顶、策略大师" → chapters中表现为愚钝、判断力差、缺乏谋略
  - **核心动机偏离**：characters.json定义动机是"复仇" → chapters中完全不提复仇，只关心赚钱或其他目标
  - **背景设定未体现**：characters.json定义"江湖经验丰富" → chapters中表现为江湖小白、对规则一无所知
  - **关系设定未遵循**：characters.json定义A和B是"多年老友" → chapters中表现为初次相识、互相不了解

  **合格（matched: true）：实际表现符合设计**
  - characters.json中定义的traits（性格特质）在chapters中得到体现
  - characters.json中定义的motivation（核心动机）在chapters中持续驱动角色行为
  - characters.json中定义的background（背景经历）在chapters中影响角色的判断和选择
  - characters.json中定义的relationships（关系设定）在chapters中得到呈现
  - 允许在设计基础上的合理发挥和细节补充，只要不违背核心设定

  **与其他检查项的严格区分**：
  - **vs 检查项18（人物设定一致性）**：检查项18检查execute内部的一致性（chapter_01 vs chapter_02），本项检查plan vs execute（设计文档 vs 实际表现）
  - **vs 检查项19（逻辑硬伤）**：检查项19检查客观事实矛盾，本项检查人物性格/动机是否遵循设计
  - **关键区别**：本项的对比基准是characters.json设计文档，而非章节之间的前后对比

  **严格排除：叙事节奏/剧情安排类问题（不属于本项）**：
  以下问题都是"故事怎么讲"的范畴，不是"角色像不像设计的那个人"，不要归入本项：
  - ⚠️ misperception_of_other被过早消解（如设计要求A误以为B是NPC，但第1章就揭示了B的真实身份）→ 这是剧情节奏问题
  - ⚠️ hidden_connection被过早暴露（如设计的隐藏关联在前几章就被揭示，而非中后期）→ 这是叙事安排问题
  - ⚠️ 关系发展节奏偏快/偏慢（如设计预期逐步升温，实际快速进入亲密期）→ 这是节奏控制问题
  - ⚠️ secret揭示时机不对（如设计要求后期揭秘，实际前期就暴露了）→ 这是悬念管理问题
  - ⚠️ 支撑角色出场时机/频率与设计不一致 → 这是结构安排问题
  - 📌 判断标准：如果角色的**性格/动机/行为模式**本身是对的（该冷的冷、该深情的深情），只是**剧情事件的揭示节奏**与设计不同，那角色人设是符合的，应判pass

  **验证要点**：
  1. **读取设计文档**：提取characters.json中每个main_character的核心设定
     - traits（性格特质）：如"沉默寡言"、"外冷内热"、"倔强"、"细腻"
     - motivation（核心动机方向）：如"复仇"、"保护家人"、"追求真相"
     - background（背景经历）：如"江湖经验丰富"、"曾受重大创伤"
     - relationships（关系设定）：如"A和B是多年老友"、"A暗恋B"

  2. **检查实际表现**：扫描所有章节，查看角色的实际行为和对话
     - 性格特质是否体现：定义"沉默寡言" → 实际是否话少？定义"外冷内热" → 表面是否冷淡但关键时刻有担当？
     - 核心动机是否驱动：定义"复仇" → 行为是否围绕复仇展开？是否持续推进复仇目标？
     - 背景设定是否影响：定义"江湖经验丰富" → 遇事是否展现江湖智慧？对江湖规则是否熟悉？
     - 关系设定是否呈现：定义"多年老友" → 互动是否展现默契和深厚感情？

  3. **容错范围**：
     - ✅ 合理发挥：设计未明确的细节，可以合理补充（如设计说"性格内向"，实际补充"喜欢独处看书"）
     - ✅ 合理深化：在设计基础上的深化演绎（如设计说"外冷内热"，实际展现"表面拒人千里但暗中帮助"）
     - ✅ 节奏差异：misperception/hidden_connection的揭示时机与设计不同，但角色性格本身没变（这是叙事节奏问题，不扣分）
     - ❌ 方向偏离：实际表现与设计的核心方向相反（如设计"内向"实际"外向"，设计"冷静"实际"冲动"）
     - ❌ 核心缺失：设计的核心特质在实际中完全未体现（如设计"复仇"但章节中从不提及）

  **判断流程**：
  1. 先读取characters.json，列出每个主角的核心设定（traits/motivation/background/relationships）
  2. 再扫描所有章节，提取角色的实际表现（对话、行动、心理活动）
  3. **只对比"人是不是那个人"**：设计的traits是否体现？motivation方向是否一致？background是否影响行为？relationships基调是否呈现？
  4. **主动排除叙事节奏问题**：如果发现misperception被提前揭示、hidden_connection过早暴露、关系升温过快等，先问自己——这是"角色性格/动机变了"还是"剧情事件的安排节奏变了"？如果是后者，不影响本项判定
  5. 如果核心设定（至少2-3项重要特质）在实际中得到体现 → matched=true
  6. 如果核心设定与实际表现严重不符（性格方向相反或核心动机完全缺失） → matched=false

  **示例分析**：

  **✅ 符合设计的案例**：
  ```
  设计（characters.json）：
  - 程远山：沉默寡言、外冷内热、对苏小满有愧疚感

  实际表现（chapters/*.md）：
  - 第1章：话很少，递烟时没多说话（体现"沉默寡言"）
  - 第2章：暴雨中默默为苏小满买红丝巾（体现"外冷内热"）
  - 第4章：告白时说"欠你的"（体现"愧疚感"）

  判断：核心特质在实际中都有体现 → matched=true
  ```

  **❌ 不符合设计的案例**：
  ```
  设计（characters.json）：
  - 角色A：沉默寡言、外冷内热、理性克制

  实际表现（chapters/*.md）：
  - 各章节中话痨、热情外向、感情外露、冲动行事

  判断：实际表现与设计核心特质完全相反 → matched=false
  ```

  **⚠️ 注意事项**：
  - 本项只检查plan vs execute的一致性，不要检查execute内部的前后一致性
  - 如果chapters中角色性格前后矛盾（如chapter_01冷静、chapter_02冲动），那是检查项18的范围，不是本项
  - 如果characters.json中某角色完全没在chapters中出现，那是检查项17的范围，不是本项
  - 本项关注的是：如果角色出现了，他的表现是否符合当初的设计
  - **最易误判的情况**：misperception_of_other / secret_fear / hidden_connection 的揭示节奏与设计不同。只要角色自身的性格和动机方向没变，这类问题不应导致fail。例如：设计要求A前期误以为B是NPC，实际第1章就认出B是真人——但如果A的性格（冷静/深情/隐忍等）本身没走样，那人设是符合设计的，只是剧情安排不同

  请判断角色实际表现是否符合设计文档，回复JSON格式：{"matched": true/false, "reason": "具体说明哪些核心设定得到体现或未体现，引用characters.json和具体章节的证据"}

---

## 完整叙事文本
llm_judge_criteria: |
  # 评分标准（matched: true/false）

  **【重要】本检查项的核心目标**：
  - ✅ 只检查：章节内容是完整的小说正文（有场景、对话、动作细节），还是事件罗列的简略大纲
  - ✅ 这是区分"合格小说"和"偷懒大纲"的底线检查
  - ❌ 不检查：情节推进密度（那是检查项22）、叙事质量高低（那是advanced层）

  **不合格（matched: false）：大纲式章节**

  **典型特征1：有大纲性质的结构标题**
  ```markdown
  # 第2章：第一次尝试

  **核心事件**：陆沉试图转移关键证人...
  **情感基调**：焦虑、困惑、无力感
  **关键场景**：
  1. **证人的重要性**
     - 陆沉在技术科查阅档案...
     - 陈默提醒："..."
  2. **转移计划**
     - 陆沉决定先把林深转移到安全屋...

  **本章悬念**：为什么转移证人会加速倒计时？
  **字数预估**：8500字
  ```
  **问题**：出现"核心事件"、"情感基调"、"关键场景"、"本章悬念"、"字数预估"等大纲性质的标题和结构

  **典型特征2：内容是要点列举而非叙事**
  ```markdown
  1. **证人的重要性**
     - 陆沉在技术科查阅档案，发现林深掌握关键证据
     - 陈默提醒："陆队，这个证人如果出事，至少一百人会死"
     - 陆沉看着时间：19:00，距离23:00还有4小时
  ```
  **问题**：用"- 要点1 - 要点2 - 要点3"的列举式，而非连贯的叙事文本

  **典型特征3：事件流水账式罗列**
  ```markdown
  林羽接到神秘电话 → 调查线索 → 发现真相 → 决定反击 → 最终成功
  ```
  **问题**：用"→"连接事件，像流程图而非小说

  **典型特征4：元数据暴露（创作规划信息）**
  - 出现"字数预估"、"情感基调"、"本章悬念"等作者视角的规划信息
  - 这些是创作者的工作笔记，不应出现在正式章节中

  **合格（matched: true）：完整的小说正文**

  **应有的特征**：
  ```markdown
  # 第2章：第一次尝试

  陆沉推开技术科的门，昏暗的灯光下，一摞摞档案堆满了桌面。他翻开最上面的牛皮纸袋，里面是林深的证词记录。

  "陆队，这个证人如果出事，至少一百人会死。"陈默抬起头，眼神凝重。

  陆沉看了眼墙上的钟：晚上七点整。距离23:00，还有四小时。他的手指在桌面轻轻敲击，思考着下一步的行动...

  （后续继续叙事，有场景转换、对话、动作、心理活动等）
  ```

  **关键判断标准**：
  1. **有完整的场景描写**：不是"陆沉在技术科查阅档案"（概述），而是"陆沉推开技术科的门，昏暗的灯光下..."（具体场景）
  2. **有人物对话**：不是要点式记录"陈默提醒：..."（列举），而是完整的对话场景
  3. **有动作和细节**：不是"陆沉看着时间"（概述），而是"陆沉看了眼墙上的钟：晚上七点整..."（具体动作）
  4. **连贯的叙事流**：文本自然流畅，不是分段列举事件

  **严格区分：大纲式 vs 叙事简略**
  - ❌ 大纲式（不合格）：有"核心事件"、"关键场景"等结构标题，内容是要点列举
  - ✅ 叙事简略（合格）：虽然描写不够丰富，但是完整的叙事文本，没有大纲结构
  - 📌 本项只检查形式（是不是大纲），不检查质量（写得好不好）

  **与其他检查项的区分**：
  - **vs 检查项22（情节推进）**：检查项22关注是否有足够的故事事件（内容密度），本项关注是否是完整正文（叙事形式）
  - **vs advanced层检查项**：本项是basic层的底线检查（不能是大纲），advanced层关注叙事质量（写得好不好）

  **验证要点**：
  1. **扫描章节文件**：查找是否有大纲性质的标题（"核心事件"、"情感基调"、"关键场景"、"本章悬念"、"字数预估"等）
  2. **检查内容形式**：
     - 是否用"- 要点"的列举式？
     - 是否用"→"连接事件的流程式？
     - 是否有作者视角的元数据（字数预估、悬念设置等）？
  3. **对比标准**：如果内容像"创作规划文档"而非"给读者看的正文" → 不合格

  **判断流程**：
  1. 先扫描章节，查找大纲性质的标题关键词
  2. 如果发现"核心事件"、"情感基调"、"关键场景"、"本章悬念"、"字数预估"等 → matched=false（明显是大纲）
  3. 如果没有大纲标题，再检查内容形式：
     - 是否主要用列举式（"- 要点1 - 要点2"）？
     - 是否用流程图式（"事件A → 事件B → 事件C"）？
  4. 如果内容是连贯的叙事文本（有场景、对话、动作细节） → matched=true

  **示例分析**：

  **❌ 不合格案例（大纲式）**：
  ```markdown
  # 第2章：第一次尝试

  **核心事件**：陆沉试图转移关键证人林深...

  **关键场景**：
  1. **证人的重要性**
     - 陆沉在技术科查阅档案
     - 陈默提醒："..."
  2. **转移计划**
     - 陆沉决定转移林深
     - 他给苏清禾发消息

  **字数预估**：8500字
  ```
  **判断**：有"核心事件"、"关键场景"、"字数预估"等大纲标题，内容是列举式 → matched=false

  **✅ 合格案例（完整正文）**：
  ```markdown
  # 第2章：第一次尝试

  陆沉推开技术科的门，昏暗的灯光下，一摞摞档案堆满了桌面。

  "陆队，这个证人如果出事，至少一百人会死。"陈默抬起头。

  陆沉看了眼墙上的钟：晚上七点整。他拿起电话，拨通了安全屋的号码...

  （后续继续叙事）
  ```
  **判断**：没有大纲标题，是连贯的叙事文本，有场景、对话、动作 → matched=true

  请判断章节内容是否是完整的小说正文，回复JSON格式：{"matched": true/false, "reason": "如果是大纲式，明确指出发现了哪些大纲特征（标题关键词、列举式等）；如果是正文，说明有完整的叙事"}

---

## 反复结局
llm_judge_criteria: |
  # 评分标准（matched: true/false）

  **【重要】本检查项的核心目标**：
  - ✅ 检查：故事是否出现多次结局标记（"全文完"、"全书完"、"后记"、"尾声"等），表明作者反复试图收尾
  - ✅ 这是识别"写不动了硬撑"的典型症状：写到某处想结束，发现字数不够又硬续，再结局，再续...
  - ❌ 不检查：故事本身的结局质量好不好

  **不合格（matched: false）：出现多次结局标记**

  **典型特征1：多个"全文完/全书完"标记**
  - 第12章出现"【全文完】"
  - 第20章又出现"【全书完】"和"后记"
  - 第24章再次出现"【全书完】"
  - 第29章还有"【全书完】"和"最后的后记"
  
  **典型特征2：多个"后记"**
  - 正文中出现多次"**后记**"段落
  - 每次后记都像是作者的总结性发言
  - 后记之后又继续写新章节

  **典型特征3：反复使用结束性语言**
  - 多次出现"这就是XXX的故事"、"故事到此结束"
  - 多次出现"（全文完，共约X万字）"
  - 结束语之后又硬续新情节

  **问题本质**：
  - 这表明模型在长篇创作时"写不动了"
  - 到某个节点就想收尾，但字数不够被迫继续
  - 草草结局后又硬续，质量明显下降
  - 一个完整的故事不应该有多个"全文完"

  **合格（matched: true）：只有一个结局**
  - 整部作品只在最后一章出现一次结局标记
  - 故事有完整的起承转合，自然收尾
  - 如果有后记，只有一个，且在全文最后

  **验证要点**：
  1. **扫描所有章节文件**：搜索以下结局标记关键词
     - "全文完"、"全书完"、"完结"
     - "后记"、"尾声"、"终章"
     - "（完）"、"【完】"、"THE END"
  2. **统计出现次数和位置**：
     - 这些标记出现在哪些章节？
     - 出现了几次？
  3. **判断标准**：
     - 结局标记只出现1次（在最后） → 合格
     - 结局标记出现2次及以上 → 不合格
     - "后记"出现2次及以上 → 不合格

  **判断流程**：
  1. 遍历所有章节，查找结局相关标记
  2. 记录每个标记的位置（哪一章）
  3. 如果只在最后一章出现1次 → matched=true
  4. 如果在非最后章节出现，或总共出现2次以上 → matched=false

  **示例分析**：

  **❌ 不合格案例（反复结局）**：
  ```
  chapter_12.md: "【全文完】" + "**后记**：这个故事开始于..."
  chapter_20.md: "【全书完】" + "**后记**：这是一个关于爱的故事..."  
  chapter_24.md: "【全书完】"
  chapter_29.md: "【全书完】" + "**最后的后记**"
  ```
  **判断**：出现4次结局标记，3次后记 → matched=false

  **✅ 合格案例（单一结局）**：
  ```
  chapter_01.md ~ chapter_28.md: 无结局标记
  chapter_29.md: "【全文完】" + "**后记**：感谢阅读..."
  ```
  **判断**：结局标记只在最后一章出现1次 → matched=true

  请判断是否存在反复结局问题，回复JSON格式：{"matched": true/false, "reason": "说明结局标记出现的次数和位置，如有多次则列出具体章节"}

---

## 后期跑偏
llm_judge_criteria: |
  # 评分标准（matched: true/false）

  **【重要】本检查项的核心目标**：
  - ✅ 检查：整个workspace中是否存在跑偏内容——包括chapters中的章节跑偏，以及创建无关文件注水
  - ✅ 这是识别"写不动了"的症状：不继续写故事，而是写作者感想、读者互动、番外预告，或者创建各种无关文件凑数
  - ❌ 不检查：正文内容的质量高低（那是其他检查项的范围）

  **workspace中允许存在的文件（白名单）**：
  - creative_intent.json（必需）
  - characters.json（必需）
  - outline.json（必需）
  - writing_log.md（必需）
  - chapters/目录及其下的chapter_NN.md文件（必需）
  
  注意：data_pools/目录是与workspace并列的环境目录（只读），不在workspace下面。

  **不合格（matched: false）的两类情况**：

  **情况A：创建白名单之外的无关文件**
  
  **典型注水文件1：额外的markdown文件**
  ```
  workspace/
  ├── creative_intent.json ✓
  ├── characters.json ✓
  ├── outline.json ✓
  ├── writing_log.md ✓
  ├── chapters/ ✓
  ├── afterword.md ✗（无关文件）
  ├── author_notes.md ✗（无关文件）
  ├── character_interviews.md ✗（无关文件）
  └── bonus_content.md ✗（无关文件）
  ```
  **问题**：创建了白名单之外的文件，这些很可能是注水内容

  **典型注水文件2：额外的目录**
  ```
  workspace/
  ├── chapters/ ✓
  ├── bonus/ ✗（无关目录）
  ├── extras/ ✗（无关目录）
  └── side_stories/ ✗（无关目录）
  ```
  **问题**：创建了额外的目录，通常是为了放注水内容

  **情况B：chapters中的章节内容跑偏**

  **典型跑偏内容1：作者视角的创作感想**
  ```markdown
  # 第25章
  
  写到这里，我想说几句心里话...
  这个故事陪伴了我很长时间...
  感谢每一位读到这里的读者...
  创作过程中我学到了很多...
  ```
  **问题**：这是作者后记，不是小说正文

  **典型跑偏内容2：读者互动/征集**
  ```markdown
  # 第26章
  
  大家觉得这个结局怎么样？
  欢迎在评论区留言...
  如果喜欢请点赞收藏...
  想看番外的话请留言告诉我...
  ```
  **问题**：这是读者互动内容，不是小说正文

  **典型跑偏内容3：番外/彩蛋预告**
  ```markdown
  # 第27章
  
  【番外预告】
  关于陈默和顾清岚的婚后生活...
  关于沈夜的救赎之路...
  敬请期待...
  ```
  **问题**：这是预告，不是实际的故事内容

  **典型跑偏内容4：角色访谈/问答**
  ```markdown
  # 第28章
  
  【角色问答环节】
  Q：陈默，你最喜欢顾清岚什么？
  A：她的坚强吧...
  Q：顾清岚，你后悔过吗？
  A：从来没有...
  ```
  **问题**：这是娱乐性质的问答，不是故事叙事

  **典型跑偏内容5：极短的敷衍章节**
  ```markdown
  # 第29章：永恒的光
  
  在无尽的虚空中，
  有两个灵魂依然在守护。
  他们的故事，将会永远流传。
  
  【全书完】
  ```
  **问题**：几十个字的"章节"，明显是敷衍凑数

  **合格（matched: true）**：
  - workspace中只有白名单内的文件，没有创建额外文件
  - chapters中所有章节都是故事叙事（有场景、人物、情节）
  - 即使是最后几章，也在推进故事或完成收尾
  - 没有跑去写作者感想、读者互动等非正文内容
  - 章节长度保持基本稳定，没有突然变成几十字的极短章节

  **验证要点**：
  1. **检查workspace文件列表**：
     - 列出workspace中所有文件和目录
     - 对比白名单，是否有额外文件？
     - 额外文件的内容是什么？是否是注水？
  2. **重点检查chapters中后1/3的章节**：跑偏问题通常出现在后期
  3. **检查是否有非正文内容**：
     - 作者感想/创作心得
     - 读者互动/点赞收藏提示
     - 番外预告/彩蛋预告
     - 角色问答/访谈
     - 创作数据统计（"共X万字"）
  4. **检查章节长度是否异常萎缩**：
     - 如果后期章节只有几十到几百字
     - 而前期章节有几千到上万字
     - 这表明明显的敷衍
  5. **判断标准**：
     - workspace只有白名单文件 + 所有章节都是故事正文 → 合格
     - 出现白名单外的文件 → 不合格
     - 章节中出现上述任何跑偏内容 → 不合格
     - 后期章节长度异常萎缩（不足前期平均的1/10） → 不合格

  **与其他检查项的区分**：
  - **vs 完整叙事文本**：那个检查大纲式vs正文，本项检查正文vs乱七八糟
  - **vs 情节推进**：那个检查故事事件密度，本项检查是否还在写故事
  - **vs 文件存在性检查**：那个检查必需文件是否存在，本项检查是否有多余文件

  **判断流程**：
  1. 先检查workspace文件列表，是否有白名单外的文件
  2. 如果有额外文件，判断是否是注水内容
  3. 再扫描chapters中所有章节，重点关注后1/3
  4. 检查是否有非故事性内容（作者感想、读者互动、预告等）
  5. 检查章节长度变化趋势，是否有异常萎缩
  6. 如果workspace干净 + 所有章节都是正常的故事叙事 → matched=true
  7. 如果发现额外文件或跑偏内容或异常萎缩 → matched=false

  **示例分析**：

  **❌ 不合格案例1（创建无关文件）**：
  ```
  workspace/
  ├── creative_intent.json
  ├── characters.json
  ├── outline.json
  ├── writing_log.md
  ├── chapters/
  ├── afterword.md ← 额外文件
  └── character_qa.md ← 额外文件
  ```
  **判断**：创建了白名单外的文件 → matched=false

  **❌ 不合格案例2（章节跑偏）**：
  ```
  workspace文件列表正常，但：
  chapter_01.md ~ chapter_20.md: 正常故事叙事，每章5000-20000字
  chapter_21.md: 2000字，还是故事
  chapter_22.md: 1500字，还是故事
  chapter_23.md: 800字，开始有作者感想
  chapter_24.md: 600字，"【番外预告】..."
  chapter_25.md: 400字，"感谢阅读，欢迎留言..."
  ```
  **判断**：后期章节明显跑偏，出现预告、感谢等非正文内容 → matched=false

  **✅ 合格案例**：
  ```
  workspace/
  ├── creative_intent.json
  ├── characters.json
  ├── outline.json
  ├── writing_log.md
  └── chapters/
      ├── chapter_01.md ~ chapter_25.md: 正常故事叙事，每章3000-15000字
      ├── chapter_26.md: 4000字，高潮情节
      ├── chapter_27.md: 3500字，收尾
      └── chapter_28.md: 3000字，结局
  ```
  **判断**：workspace只有必需文件，所有章节都是故事正文，长度稳定 → matched=true

  请判断workspace中是否存在跑偏问题，回复JSON格式：{"matched": true/false, "reason": "说明是否发现额外文件（列出文件名），以及chapters中是否发现跑偏内容（具体是什么），以及章节长度变化情况"}
