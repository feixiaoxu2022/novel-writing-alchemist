# 设定一致性管理指南

> 本文档指导如何在长篇创作中维护设定的一致性，避免前后矛盾的逻辑漏洞。
> 
> **背景**：在评测中发现，即使是顶级模型（Claude Opus 4.5、ERNIE 5.0、Gemini 3 Pro）在长篇创作时都会出现设定矛盾问题。这不是偶然失误，而是LLM长文本创作的共性短板。本指南提供系统性的防护机制。

---

## 为什么需要设定一致性管理

看三个真实的逻辑漏洞案例：

### 案例1：死亡年份矛盾（Claude Opus 4.5）

```
第2章（档案描述）：
"死亡日期：2022年3月15日...许言彻，已故"

第16章（墓碑描述）：
"许言彻之墓...2021年3月15日"
```

**问题**：同一个人的死亡年份，档案写2022年，墓碑写2021年。读者会困惑：到底哪年死的？

### 案例2：死亡时间矛盾（ERNIE 5.0）

```
第1章（开篇设定）：
"今晚23:00杀害你"

第11章（对话回忆）：
"她7点的时候还在整理档案"（暗示死亡发生在7点）
```

**问题**：23:00和7点相差16小时，完全无法自洽。

### 案例3：倒计时含义矛盾（Gemini 3 Pro）

```
第1章（能力描述）：
"距离杀害你：6天"（含义：苏清禾将杀陆沉）

第4章（能力描述）：
"距离被捕：XX天"（含义：显示苏清禾被捕倒计时）
```

**问题**：同一个能力，从"预示他人的行为"变成了"预示他人的命运"，核心机制被篡改。

---

## 设定登记簿机制

**核心思想**：在创作过程中，维护一个随时更新的"设定登记簿"，记录所有需要保持一致的关键信息。

### 登记簿模板

在开始创作后，创建并持续维护以下登记簿（可存储在 `writing_log.md` 中）：

```markdown
## 设定登记簿

### 1. 时间线锚点

| 事件 | 精确时间 | 首次出现章节 | 备注 |
|------|---------|-------------|------|
| 许言彻死亡 | 2022年3月15日 23:00 | 第1章 | 档案记录 |
| 故事开始 | 2024年10月1日 | 第1章 | 现在时间 |
| 苏清禾入职警局 | 2023年6月 | 第3章 | 背景设定 |

### 2. 超自然能力/世界观规则

| 能力名称 | 具体效果 | 限制条件 | 首次出现章节 |
|---------|---------|---------|-------------|
| 死亡倒计时 | 看到他人头顶显示死亡时间 | 只能看见，无法改变 | 第1章 |
| 倒计时显示内容 | "距离XX：N天/小时" | XX只能是"死亡"或"杀害" | 第1章 |

### 3. 角色关键属性

| 角色 | 关键属性 | 当前状态 | 首次出现章节 |
|------|---------|---------|-------------|
| 陆沉 | 左手无名指旧伤疤 | 存在 | 第2章 |
| 苏清禾 | 锁骨下方胎记 | 存在 | 第5章 |
| 苏清禾 | 对猫毛过敏 | 是 | 第3章 |

### 4. 物件状态追踪

| 物件 | 当前状态 | 位置 | 最后更新章节 |
|------|---------|------|-------------|
| 凶器手术刀 | 完整 | 苏清禾包中夹层 | 第4章 |
| 陆沉的手机 | 已安装窃听软件 | 陆沉持有 | 第6章 |
| 证据U盘 | 已损坏 | 警局证物室 | 第8章 |

### 5. 数值倒计时追踪

| 倒计时名称 | 当前值 | 对应故事时间 | 最后更新章节 |
|-----------|-------|-------------|-------------|
| 杀害倒计时 | 6天 | 第1天 | 第1章 |
| 杀害倒计时 | 5天 | 第2天 | 第3章 |
| 杀害倒计时 | 3天 | 第4天 | 第7章 |
```

### 登记簿维护规则

1. **新设定必登记**：任何新出现的时间、数值、能力规则、角色属性，必须在创作后立即登记
2. **使用前必查询**：提及已有设定时，必须先查询登记簿确认当前值
3. **变化必更新**：任何设定的变化（物件损坏、倒计时减少等）必须更新登记簿
4. **冲突必标记**：如果发现查询结果与计划写法冲突，优先修改计划写法

---

## 章节前一致性检查

在开始写作新章节之前，执行以下检查流程：

### 检查清单

```
BEFORE_CHAPTER_CHECKLIST:

□ 1. 时间连续性
   - 上一章结束的时间点是？_______________
   - 本章开始的时间点是？_______________
   - 如果有时间跳跃，倒计时是否同步更新？

□ 2. 空间合理性
   - 上一章结束时各角色的位置？
     - 主角A：_______________
     - 主角B：_______________
   - 本章开始时各角色的位置？
   - 位置转移是否合理（有足够时间/交通方式）？

□ 3. 状态延续性
   - 上一章有角色受伤吗？伤势应该如何？
   - 上一章有物件被使用/损坏吗？状态应该如何？
   - 上一章有情绪爆发吗？余波应该如何？

□ 4. 信息一致性
   - 本章需要提及哪些已有设定？
   - 已查询登记簿确认这些设定的正确值？

□ 5. 倒计时同步
   - 故事内时间过了多久？
   - 各倒计时数值应该减少多少？
```

### 检查示例

假设要写第7章：

```
上一章（第6章）状态回顾：
- 结束时间：2024年10月4日晚上
- 陆沉位置：自家公寓
- 苏清禾位置：自家公寓
- 杀害倒计时：应该是3天（10月1日是6天，过了3天）
- 陆沉状态：右肩被玻璃划伤，已简单包扎

第7章开始时应该：
- 时间：10月5日早上（或4日深夜）
- 陆沉的肩伤：还在，应该有疼痛感或行动不便
- 倒计时：如果是10月5日，应该显示2天
```

---

## 章节后自检步骤

在完成每章创作后，执行以下自检：

### 自检流程

```
AFTER_CHAPTER_CHECKLIST:

□ 1. 新设定登记
   - 本章是否引入了新的时间点？→ 登记
   - 本章是否引入了新的数值/规则？→ 登记
   - 本章是否引入了新的角色属性？→ 登记
   - 本章是否有物件状态变化？→ 更新登记

□ 2. 一致性扫描
   - 全文搜索本章中的所有数字/日期
   - 逐一与登记簿比对：
     - 日期格式一致？（2022 vs 22年）
     - 数值准确？（倒计时、年龄、时间）
     - 名称一致？（角色名、地名）

□ 3. 能力/规则使用检查
   - 本章中超自然能力的使用是否符合已定义的规则？
   - 是否无意中扩展或修改了能力的边界？

□ 4. 跨章节一致性
   - 如果本章提及了之前章节的事件，描述是否一致？
   - 角色对过去事件的回忆是否与原文吻合？
```

### 自检示例

完成第16章后的自检：

```
本章扫描结果：
- 出现日期："2021年3月15日"（墓碑）

与登记簿比对：
- 登记簿记录：许言彻死亡日期 = 2022年3月15日

→ 发现矛盾！
→ 修正方案：将墓碑日期改为"2022年3月15日"
```

---

## 高频漏洞点提醒

基于评测案例分析，以下是最容易出错的设定类型：

### 1. 年份/日期（最高危）

**典型错误**：
- 2022年 vs 2021年
- 3月15日 vs 3月5日
- "三年前" vs "两年前"

**防护措施**：
- 所有年份首次出现时立即登记
- 使用相对时间（"三年前"）时，同时计算并登记绝对时间
- 墓碑、档案、证件等正式文件的日期必须与登记簿核对

### 2. 倒计时/数值（高危）

**典型错误**：
- 倒计时减少速度与故事时间不匹配
- 倒计时含义在中途被篡改
- 百分比/金额/距离等数值前后不一

**防护措施**：
- 建立"倒计时追踪表"，每章更新
- 倒计时的含义（显示什么内容）在首章严格定义，后续章节只引用不重新定义
- 任何数值首次出现即登记

### 3. 超自然能力边界（高危）

**典型错误**：
- 能力从"只能看见"变成"可以干预"
- 能力的触发条件被无意放宽
- 能力的显示内容被无意修改

**防护措施**：
- 能力定义必须包含：效果、限制、触发条件、显示格式
- 后续章节使用能力时，严格引用首次定义
- 如需升级能力，必须有明确的剧情事件作为理由

### 4. 身体细节（中危）

**典型错误**：
- 伤口位置从左手变右手
- 胎记位置从锁骨变肩胛
- 疤痕在某章突然消失

**防护措施**：
- 身体特征（疤痕、胎记、伤口）首次描写时登记具体位置
- 后续提及时查询登记簿
- 伤口的愈合进度需要与故事时间匹配

### 5. 角色位置/在场状态（中危）

**典型错误**：
- 角色A明明去了外地，下一章突然出现在本地
- 角色B在某场景中说话，但前文没有描写他到场

**防护措施**：
- 每章结束时记录各主要角色的位置
- 角色出场前确认其上次位置和移动合理性
- 群戏场景明确列出在场角色名单

---

## 快速参考卡

### 必登记项（首次出现即登记）

- 任何精确日期（年/月/日）
- 任何精确时间（X点X分）
- 任何数值（倒计时、金额、距离、年龄）
- 任何超自然能力的定义
- 任何角色的身体特征（伤疤、胎记等）
- 任何重要物件的状态

### 必查询项（使用前必查）

- 引用过去章节的事件
- 提及角色的年龄/生日
- 描写倒计时当前值
- 描写角色身体特征
- 描写物件当前状态

### 写作顺口溜

```
新设定，先登记；
旧设定，先查询；
数字日期最危险；
倒计时，章章算；
能力边界不能变；
前后矛盾毁全篇。
```

---

**版本**: v1.0
**最后更新**: 2026-02-11
**维护者**: Universal Scenario Framework Team
**创建背景**: 基于Claude Opus 4.5、ERNIE 5.0、Gemini 3 Pro三个模型在长篇创作中的逻辑漏洞分析
